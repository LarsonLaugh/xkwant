(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 13.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[      7934,        210]
NotebookOptionsPosition[      7447,        193]
NotebookOutlinePosition[      7850,        209]
CellTagsIndexPosition[      7807,        206]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"Load", " ", "necessary", " ", "package"}], "*)"}], 
  RowBox[{
   RowBox[{
    RowBox[{
    "Needs", "[", "\"\<DifferentialEquations`NDSolveUtilities`\>\"", "]"}], 
    ";"}], "\n", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
    "Define", " ", "the", " ", "Hamiltonian", " ", "matrix", " ", 
     "function"}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"mat", "[", 
      RowBox[{"kx_", ",", "ky_", ",", "hg_"}], "]"}], ":=", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"0", ",", 
         RowBox[{
          RowBox[{"-", "ky"}], "-", 
          RowBox[{"I", " ", "kx"}]}], ",", "0", ",", "hg"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{
          RowBox[{"-", "ky"}], "+", 
          RowBox[{"I", " ", "kx"}]}], ",", "0", ",", "hg", ",", "0"}], "}"}], 
       ",", 
       RowBox[{"{", 
        RowBox[{"0", ",", "hg", ",", "0", ",", 
         RowBox[{"ky", "+", 
          RowBox[{"I", " ", "kx"}]}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"hg", ",", "0", ",", 
         RowBox[{"ky", "-", 
          RowBox[{"I", " ", "kx"}]}], ",", "0"}], "}"}]}], "}"}]}], ";"}], 
   "\n", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
    "Define", " ", "a", " ", "function", " ", "to", " ", "compute", " ", 
     "eigenvalues", " ", "and", " ", "sort", " ", "them"}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"computeEigenvalues", "[", 
      RowBox[{"mat_", ",", "kx_", ",", "ky_", ",", "hg_"}], "]"}], ":=", 
     RowBox[{"Sort", "[", 
      RowBox[{"Eigenvalues", "[", 
       RowBox[{"mat", "[", 
        RowBox[{"kx", ",", "ky", ",", "hg"}], "]"}], "]"}], "]"}]}], ";"}], 
   "\n", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
    "Define", " ", "a", " ", "function", " ", "to", " ", "update", " ", "the",
      " ", "plot"}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"updatePlot", "[", 
      RowBox[{"ky_", ",", "hg_"}], "]"}], ":=", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"kxValues", ",", "eigenvalues"}], "}"}], ",", 
       RowBox[{
        RowBox[{"kxValues", "=", 
         RowBox[{"Range", "[", 
          RowBox[{
           RowBox[{"-", "Pi"}], ",", "Pi", ",", "0.1"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"eigenvalues", "=", 
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{"computeEigenvalues", "[", 
            RowBox[{"mat", ",", "kx", ",", "ky", ",", "hg"}], "]"}], ",", 
           RowBox[{"{", 
            RowBox[{"kx", ",", "kxValues"}], "}"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"ListLinePlot", "[", 
         RowBox[{
          RowBox[{"Transpose", "[", 
           RowBox[{"Re", "[", "eigenvalues", "]"}], "]"}], ",", 
          RowBox[{"DataRange", "->", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"-", "Pi"}], ",", "Pi"}], "}"}]}], ",", 
          RowBox[{"PlotLegends", "->", 
           RowBox[{"{", 
            RowBox[{
            "\"\<Eigenvalue 1\>\"", ",", "\"\<Eigenvalue 2\>\"", ",", 
             "\"\<Eigenvalue 3\>\"", ",", "\"\<Eigenvalue 4\>\""}], "}"}]}], 
          ",", 
          RowBox[{"AxesLabel", "->", 
           RowBox[{"{", 
            RowBox[{"\"\<kx\>\"", ",", "\"\<Eigenvalue\>\""}], "}"}]}], ",", 
          RowBox[{
          "PlotLabel", "->", 
           "\"\<Eigenvalues of A(x) as a function of kx\>\""}], ",", 
          RowBox[{"GridLines", "->", 
           RowBox[{"{", 
            RowBox[{"None", ",", "Automatic"}], "}"}]}], ",", 
          RowBox[{"PlotRange", "->", "All"}]}], "]"}]}]}], "]"}]}], ";"}], 
   "\n", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
    "Interactive", " ", "sliders", " ", "for", " ", "ky", " ", "and", " ", 
     "hg"}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{"Manipulate", "[", 
    RowBox[{
     RowBox[{"updatePlot", "[", 
      RowBox[{"ky", ",", "hg"}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"ky", ",", "0", ",", "\"\<ky\>\""}], "}"}], ",", 
       RowBox[{"-", "0.5"}], ",", "0.5", ",", "0.01"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"hg", ",", "0", ",", "\"\<hg\>\""}], "}"}], ",", 
       RowBox[{"-", "0.5"}], ",", "0.5", ",", "0.01"}], "}"}]}], "]"}], 
   "\n"}]}]], "Input",
 CellChangeTimes->{{3.930731304498597*^9, 3.930731304499662*^9}, {
   3.930731452500393*^9, 3.93073146356804*^9}, {3.9318350044173317`*^9, 
   3.9318350120795813`*^9}, 3.931835162254035*^9},
 CellLabel->"In[11]:=",ExpressionUUID->"8d3bd2cc-103d-4a5f-a301-1e7ced841dd4"],

Cell[BoxData[
 TagBox[
  StyleBox[
   DynamicModuleBox[{$CellContext`hg$$ = -0.39, $CellContext`ky$$ = -0.3, 
    Typeset`show$$ = True, Typeset`bookmarkList$$ = {}, 
    Typeset`bookmarkMode$$ = "Menu", Typeset`animator$$, Typeset`animvar$$ = 
    1, Typeset`name$$ = "\"untitled\"", Typeset`specs$$ = {{{
       Hold[$CellContext`ky$$], 0, "ky"}, -0.5, 0.5, 0.01}, {{
       Hold[$CellContext`hg$$], 0, "hg"}, -0.5, 0.5, 0.01}}, 
    Typeset`size$$ = {477., {119., 125.}}, Typeset`update$$ = 0, 
    Typeset`initDone$$, Typeset`skipInitDone$$ = True}, 
    DynamicBox[Manipulate`ManipulateBoxes[
     1, StandardForm, 
      "Variables" :> {$CellContext`hg$$ = 0, $CellContext`ky$$ = 0}, 
      "ControllerVariables" :> {}, 
      "OtherVariables" :> {
       Typeset`show$$, Typeset`bookmarkList$$, Typeset`bookmarkMode$$, 
        Typeset`animator$$, Typeset`animvar$$, Typeset`name$$, 
        Typeset`specs$$, Typeset`size$$, Typeset`update$$, Typeset`initDone$$,
         Typeset`skipInitDone$$}, 
      "Body" :> $CellContext`updatePlot[$CellContext`ky$$, $CellContext`hg$$],
       "Specifications" :> {{{$CellContext`ky$$, 0, "ky"}, -0.5, 0.5, 
         0.01}, {{$CellContext`hg$$, 0, "hg"}, -0.5, 0.5, 0.01}}, 
      "Options" :> {}, "DefaultOptions" :> {}],
     ImageSizeCache->{523., {186.6875, 192.3125}},
     SingleEvaluation->True],
    Deinitialization:>None,
    DynamicModuleValues:>{},
    SynchronousInitialization->True,
    UndoTrackedVariables:>{Typeset`show$$, Typeset`bookmarkMode$$},
    UnsavedVariables:>{Typeset`initDone$$},
    UntrackedVariables:>{Typeset`size$$}], "Manipulate",
   Deployed->True,
   StripOnInput->False],
  Manipulate`InterpretManipulate[1]]], "Output",
 CellChangeTimes->{
  3.9307313137324963`*^9, {3.9307313635088673`*^9, 3.93073136683562*^9}, {
   3.930731471051714*^9, 3.9307314927979193`*^9}, 3.931834724364771*^9, {
   3.9318348430225363`*^9, 3.931834844611507*^9}, {3.931835017463193*^9, 
   3.931835040848023*^9}, {3.931835166128726*^9, 3.9318351718313932`*^9}},
 CellLabel->"Out[15]=",ExpressionUUID->"aa8d1cf5-31ee-41d8-9c1b-1daa72b1dfec"]
}, Open  ]]
},
WindowSize->{1440., 782.25},
WindowMargins->{{1440, Automatic}, {Automatic, 27.75}},
FrontEndVersion->"13.0 for Linux x86 (64-bit) (December 2, 2021)",
StyleDefinitions->"Default.nb",
ExpressionUUID->"0b8e0a14-41e4-46d6-b3a2-d839d2148411"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[580, 22, 4745, 126, 360, "Input",ExpressionUUID->"8d3bd2cc-103d-4a5f-a301-1e7ced841dd4"],
Cell[5328, 150, 2103, 40, 421, "Output",ExpressionUUID->"aa8d1cf5-31ee-41d8-9c1b-1daa72b1dfec"]
}, Open  ]]
}
]
*)

